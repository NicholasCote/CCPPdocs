<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="title" content="NCAR | CISL Cloud Pilot">
  <meta name="description" content="UCAR">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta class="foundation-mq">
  <link rel="canonical" href="https://www.ucar.edu/">
  <link rel="shortcut icon" href="/assets/koru-base/img/app-favicons/ncar/favicon.ico">

  <title>NCAR | CISL Cloud Pilot | CISL Cloud Pilot Project</title>

  <link rel="stylesheet" href="/assets/koru-base/lib/font-awesome/css/font-awesome.min.css" media="all">
  <link rel="stylesheet" href="/assets/koru-base/lib/icomoon/style.css" media="all">
  <link rel="stylesheet" href="/assets/koru-base/css/foundation.min.css" media="all">
  <link rel="stylesheet" href="/assets/css/styles.css" media="all">

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id="></script>
  <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', '');
  </script>

</head>


<body class="ncar with-sidebar test">
    <div class="content-wrapper">
    <header>
    <div data-sticky-container="" class="sticky-container">
        <div data-sticky="" data-options="marginTop:0;stickyOn:small;" data-top-anchor="main-content"
             class="sticky is-anchored is-at-top">
            <div class="top-bar align-top hide-for-print" id="top-bar">
                <div class="grid-x">
                    <div class="cell">
                        <div class="grid-x align-middle">
                            <div class="cell small-3 large-2">
                                <div class="grid-x grid-margin-x nsf-logo">
                                    <div class="cell small-4">
                                        <div class="grid-x">
                                            <div class="cell small-1 small-4 xlarge-3">
                                                <p><a href="https://ncar.ucar.edu/who-we-are/funding">Sponsored By</a></p>
                                                <a href="https://ncar.ucar.edu/who-we-are/funding"><img alt="NSF Logo" src="/assets/koru-base/img/NSF_4-Color_bitmap_Logo.png"/></a>
                                            </div>
                                        </div>
                                    </div>
                                </div></div>
                            <div class="cell small-6 large-8 top-bar-title logo-wrapper align-center">
                                <h2 class="acronym-wrapper">
                                    <a href="https://ncar.ucar.edu" title="NCAR Home">
                                        <img src="/assets/koru-base/img/logo-ncar-active-large.png"
                                             alt="NCAR">
                                        <span class="show-for-sr">NCAR</span>
                                    </a>
                                </h2>
                                <h1><a href="/">CISL Cloud Pilot Project</a></h1>
                            </div>
                            <div class="cell small-3 large-2 text-right"><p class="ncar-title"><a href="https://ncar.ucar.edu">National Center for Atmospheric Research</a></p></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mobile-nav hide-for-print text-center" data-responsive-toggle="main-nav" data-hide-for="mlarge">
                <div class="title-bar-title">Menu</div>
                <button class="fa fa-chevron-down" type="button" data-toggle="main-nav"></button>
            </div>
            <div class="main-nav hide-for-print" id="main-nav">
                <div class="grid-x">
                <nav class="cell center mlarge-10 large-7">
                    <ul class="menu icons icon-left" data-responsive-menu="accordion mlarge-dropdown">
                        
                        <li aria-label="Home">
                            <a class="text-center" href="/index.html">Home</a>
                            
                        </li>
                        
                        <li aria-label="About the Project">
                            <a class="text-center" href="/pages/about/about.html">About the Project</a>
                            
                            <ul class="menu">
                                <li aria-label="About the Project"><a class="text-center" href="/pages/about/about.html">Overview</a></li>
                                
                                <li aria-label="Use Cases"><a class="text-left" href="/pages/about/use-cases.html">Use Cases</a></li>
                                
                            </ul>
                            
                        </li>
                        
                        <li aria-label="Availability">
                            <a class="text-center" href="/pages/availability/availability.html">Availability</a>
                            
                            <ul class="menu">
                                <li aria-label="Availability"><a class="text-center" href="/pages/availability/availability.html">Overview</a></li>
                                
                                <li aria-label="Hardware"><a class="text-left" href="/pages/availability/hw-resources.html">Hardware</a></li>
                                
                                <li aria-label="Potential Features"><a class="text-left" href="/pages/availability/features.html">Potential Features</a></li>
                                
                                <li aria-label="Potential Services"><a class="text-left" href="/pages/availability/services.html">Potential Services</a></li>
                                
                            </ul>
                            
                        </li>
                        
                        <li aria-label="How-Tos">
                            <a class="text-center" href="/pages/how-to/index.html">How-Tos</a>
                            
                            <ul class="menu">
                                <li aria-label="How-Tos"><a class="text-center" href="/pages/how-to/index.html">Overview</a></li>
                                
                                <li aria-label="Agile Interaction"><a class="text-left" href="/pages/how-to/agile.html">Agile Interaction</a></li>
                                
                                <li aria-label="Build Documentation"><a class="text-left" href="/pages/how-to/build-docs.html">Build Documentation</a></li>
                                
                                <li aria-label="Install JupyterHub on K8s"><a class="text-left" href="/pages/how-to/k8sJH/install.html">Install JupyterHub on K8s</a></li>
                                
                                <li aria-label="Create custom Jupyter container"><a class="text-left" href="/pages/how-to/k8sJH/customize-docker.html">Create custom Jupyter container</a></li>
                                
                                <li aria-label="Setup GitHub action to build and push Docker Images"><a class="text-left" href="/pages/how-to/k8sJH/setup-gh-act.html">Setup GitHub action to build and push Docker Images</a></li>
                                
                            </ul>
                            
                        </li>
                        
                        <li aria-label="Contact Us">
                            <a class="text-center" href="/pages/contact/contact.html">Contact Us</a>
                            
                        </li>
                        
                    </ul>
                </nav>
                </div>
            </div>
        </div>
    </div>
</header>

        <div class="body-content" id="main-content">
            <div class="cell banner">
    <div class="grid-x align-center-middle">
        <div class="cell text-center">
            <div class="grid-y banner-content">
                <h1 class="cell">CISL Cloud Pilot</h1>
                <p class="cell" style="color:#fff; font-size:1.4rem;">Check progress on our up to date Kanban</p>
                <div class="cell">
                    <a class="cta-link large white-on-color" href="https://jira.ucar.edu/secure/RapidBoard.jspa?rapidView=220&projectKey=CCPP" target="_blank">Link to Kanban Page</a>
                </div>
            </div>
        </div>
    </div>
</div>
            <section class="panel primary-content">
        <div class="grid-x align-center">
            <div class="cell medium-8 large-9">
                <article role="article" class="content">
                    <h1 id="how-to-customize-a-jupyter-docker-image-for-single-users">How to Customize a Jupyter Docker Image for Single Users</h1>

<p>The Jupyter environment spun up for the users can be customized by building on top of the base Jupyter Docker image. For this use case the scipy-notebook image from Jupyter is used. That image is built upon other customized images with the base using the ubuntu:22.04 image.</p>

<p>This example Dockerfile has comments inline to explain what the lines are doing</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># NCAR CISL Customized version of the Jupyter scipy-notebook Docker image
# https://github.com/jupyter/docker-stacks/blob/main/scipy-notebook/
# This is built on a collection of Docker images from jupyter but the base image is ubuntu:22.04
# https://github.com/jupyter/docker-stacks/blob/main/docker-stacks-foundation/Dockerfile

ARG BASE_CONTAINER=jupyter/scipy-notebook:latest
FROM $BASE_CONTAINER

# Replace with team name and email
LABEL maintainer="Nick Cote &lt;ncote@ucar.edu&gt;"

# Set to root user for apt-get commands to follow
USER root

# Update to the latest package version list
RUN apt-get update --yes &amp;&amp; \
# Install required OS packages and force yes to any installation prompts
    apt-get install --yes --no-install-recommends \
# List of OS packages to be installed
    vim \
    curl \
    emacs &amp;&amp; \
# Clear /var/cache/apt directories that contain leftover pacakge files 
    apt-get clean &amp;&amp; \
# Remove lists of available packages to save space
    rm -rf /var/lib/apt/lists/*

# Copy environment.yml file with list of python packages to be installed to the user home directory
COPY configs/jupyter/base-notebook/environment.yml /home/$NB_USER/

# Switch to local user for installing user level packages
USER $NB_UID

# Run a list of commands in user space to install packages and clean up environment
# mamba is used instead of conda to speed up the installation
RUN mamba install --quiet --yes \
# nb_conda_kernels is required to save user environments as custom user notebook kernels that persist
    'conda-forge::nb_conda_kernels' &amp;&amp; \
# Create a kernel named cisl-cloud-base from the environment.yml file
    mamba env update --name cisl-cloud-base -f environment.yml &amp;&amp; \
# Install nbgitpuller via pip 
    pip install --no-cache-dir nbgitpuller &amp;&amp; \
# Use mamba to remove unused packages and caches including writable packages and do no ask to confirm
    mamba clean --all -f -y &amp;&amp; \
# Use jupyter lab to remove unused packages and caches and do no ask to confirm
    jupyter lab clean -y &amp;&amp; \
# Use npm to remove data in cache and do no ask to confirm
    npm cache clean --force &amp;&amp; \
# Remove unneeded cache files
    rm -rf /home/$NB_USER/.cache/yarn &amp;&amp; \
    rm -rf /home/$NB_USER/.node-gyp &amp;&amp; \
# Remove the environment.yml file to allow permissions to be correct
    rm environment.yml &amp;&amp; \
# Run jupyter fix-permissions script to make sure all files are writable
    fix-permissions $CONDA_DIR &amp;&amp; \
    fix-permissions /home/$NB_USER

# Copy the .condarc file to allow for saving of user custom conda environments
COPY configs/jupyter/base-notebook/.condarc /
COPY configs/jupyter/base-notebook/environment.yml /

# Make sure the notebook user is set to be the default
USER $NB_UID
</code></pre></div></div>

                </article>
            </div>
        </div>
    </section>
        </div>

    <footer>
    <div class="grid-x grid-padding-y footer-menu-tertiary">
        <div class="cell text-center">
            <small>©  UCAR</small>
            <ul class="menu vertical">
                <li><a href="https://www.ucar.edu/privacy-notice">Privacy</a></li>
                <li><a href="https://www.ucar.edu/cookie-other-tracking-technologies-notice">Cookies</a></li>
                <li><a href="https://www.ucar.edu/terms-of-use">Terms of Use</a></li>
                <li><a href="https://www.ucar.edu/notification-copyright-infringement-digital-millenium-copyright-act">Copyright Issues</a></li>
                <li><a href="https://nsf.gov">Sponsored by NSF</a></li>
                <li><a href="https://ncar.ucar.edu">NCAR Home</a></li>
                <li><a href="https://www.ucar.edu">UCAR Home</a></li>
            </ul>
        </div>
    </div>
    <div class="grid-x grid-padding-y footer-sponsor">
        <div class="cell">
            <div class="grid-container">
                <div class="grid-x">
                    <div class="cell small-auto medium-10 description">
                        <p>The National Center for Atmospheric Research is sponsored by the National Science Foundation. Any opinions, findings and conclusions or recommendations expressed in this material do not necessarily reflect the views of the National Science Foundation.</p>
                    </div>
                    <div class="cell small-3 medium-2 mlarge-1 logo">
                        <a href="https://www.nsf.gov/" target="_blank"><img src="/assets/koru-base/img/footer-logo-nsf.png" alt="National Science Foundation"></a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>
    </div>
</body>

<script src="/assets/koru-base/lib/jquery/dist/jquery.js"></script>
<script src="/assets/koru-base/lib/foundation-sites/dist/js/foundation.js"></script>
<script src="/assets/koru-base/js/main.min.js"></script>
</html>